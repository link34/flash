<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:h="http://java.sun.com/jsf/html">

	<ui:composition template="/WEB-INF/template.xhtml">
		<ui:define name="title">
			Users
		</ui:define>
		
		<ui:define name="content">
			<!-- Search Box -->
			<h:form>
			<div class="card">
				<div class="row card-content">
					<div class="col s3 input-field">
						<h:selectOneMenu value="#{userBean.status}">
							<f:selectItems value="#{userBean.statusList}" var="sts" itemValue="#{sts}" itemLabel="#{sts}"></f:selectItems>
						</h:selectOneMenu>
					</div>
					<div class="col s7 input-field">
						<h:inputText value="#{userBean.name}" />
						<h:outputLabel value="User Name" />
					</div>
					<div class="col s2">
						<h:commandLink styleClass="btn-floating MarTop20" actionListener="#{userBean.search()}">
							<i class="material-icons">search</i>
							<f:ajax execute="@form" render="searchResult"></f:ajax>
						</h:commandLink>
					</div>
				</div>
			</div>
			</h:form>
			
			<!-- Search Result -->
			<h:form id="searchResult">
			<h:panelGroup >
				<ui:repeat var="user" value="#{userBean.users}">
					<div class="card">
						<div class="card-content">
							<h:outputText value="#{user.name} (#{user.loginId})" styleClass="card-title" />
							
							<h:commandLink styleClass="right btn-floating red" 
								actionListener="#{userBean.switchStatus(user)}" >
								<i class="material-icons">#{user.status eq 'Valid' ? 'lock' : 'lock_open' }</i>								
								<f:ajax execute="@this" render="searchResult"></f:ajax>								
							</h:commandLink>
													
							<div class="divider" />
							
							<div class="row MarTop10">
								<div class="col l6 center-align">
									<h:graphicImage name="user.png" library="img" styleClass="card-image responsive-img" />
									<h:outputText value="#{user.status}" /><br/>
									<h:outputText value="#{user.security.creation}" converter="#{commonDateTimeConverter}" />
									<h:outputText value="#{user.email}" styleClass="grey-text"/>
								</div>
								<div class="col l6">
									<!-- Blogs -->
									<div class="card blue-grey darken-2 white-text">
										<div class="card-content">
											<i class="material-icons Fs36">description</i>
											<h:outputText value="#{user.blogsCount}" styleClass="Fs24 right" /><br/>
											<h:outputText value="Publish Counts" styleClass="Fs10 right" />
										</div>
										<div class="card-action white" >
											<h:link value="Show All" outcome="/admin/blogs" styleClass="blue-grey-text text-darken-3">
												<f:param name="user" value="#{user.loginId}"></f:param>
											</h:link>
										</div>
									</div>

									<!-- Comments  -->
									<div class="card pink darken-2 white-text">
										<div class="card-content">
											<i class="material-icons Fs36">chat</i>
											<h:outputText value="#{user.commentCount}" styleClass="Fs24 right" /><br/>
											<h:outputText value="Comment Counts" styleClass="Fs10 right" />
										</div>
										<div class="card-action white" >
											<h:link value="Show All" outcome="/admin/comments" styleClass="pink-text text-darken-3">
												<f:param name="user" value="#{user.loginId}"></f:param>
											</h:link>
										</div>
									</div>
								</div>
							</div>
							
						</div>					
					</div>				 
				</ui:repeat>
			</h:panelGroup>
			</h:form>
			
			
		</ui:define>
	</ui:composition>
</html>